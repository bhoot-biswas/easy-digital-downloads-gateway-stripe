!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,r){"use strict";r.r(t);var n,i,s=r(0),o=r.n(s),a=r(1),u=r.n(a);r(3);n=jQuery,i=function(){function e(){o()(this,e);try{this.stripe=Stripe(eddStripeParams.key)}catch(e){return void console.log(e)}this.elements=this.stripe.elements(),this.onSubmit=this.onSubmit.bind(this),this.createElements=this.createElements.bind(this),this.sourceResponse=this.sourceResponse.bind(this),this.init()}return u()(e,[{key:"init",value:function(){var e=n(document.body),t=n(document.getElementById("edd_purchase_form"));n(t).length&&(this.form=t,this.form.on("submit",this.onSubmit),e.on("edd_gateway_loaded",this.createElements),n(document).ajaxComplete((function(e,t,r){})),this.maybeConfirmIntent())}},{key:"createElements",value:function(){if(n("#stripe-card-element").length){var e={base:{iconColor:"#666EE8",color:"#31325F",fontSize:"15px","::placeholder":{color:"#CFD7E0"}}},t={focus:"focused",empty:"empty",invalid:"invalid"},r=this;void 0===this.stripe_card&&(this.stripeCard=this.elements.create("cardNumber",{style:e,classes:t}),this.stripeExp=this.elements.create("cardExpiry",{style:e,classes:t}),this.stripeCvc=this.elements.create("cardCvc",{style:e,classes:t}),this.stripeCard.addEventListener("change",(function(e){r.onCCFormChange(),r.updateCardBrand(e.brand),e.error&&n(document.body).trigger("stripeError",e)})),this.stripeExp.addEventListener("change",(function(e){r.onCCFormChange(),e.error&&n(document.body).trigger("stripeError",e)})),this.stripeCvc.addEventListener("change",(function(e){r.onCCFormChange(),e.error&&n(document.body).trigger("stripeError",e)}))),this.mountElements()}}},{key:"mountElements",value:function(){this.stripeCard.mount("#stripe-card-element"),this.stripeExp.mount("#stripe-exp-element"),this.stripeCvc.mount("#stripe-cvc-element")}},{key:"maybeConfirmIntent",value:function(){if(n("#stripe-intent-id").length&&n("#stripe-intent-return").length){var e=n("#stripe-intent-id").val(),t=n("#stripe-intent-return").val();this.openIntentModal(e,t,!0,!1)}}},{key:"openIntentModal",value:function(e,t,r,i){this.stripe[i?"handleCardSetup":"handleCardPayment"](e).then((function(e){if(e.error)throw e.error;var r=e[i?"setupIntent":"paymentIntent"];"requires_capture"!==r.status&&"succeeded"!==r.status||(window.location=t)})).catch((function(e){if(r)return window.location=t;n(document.body).trigger("stripeError",{error:e}),n.get(t+"&is_ajax")}))}},{key:"onSubmit",value:function(){return!this.isStripeChosen()||!!this.hasSource()||(this.createSource(),!1)}},{key:"isStripeChosen",value:function(){return n("#edd-gateway-stripe").is(":checked")}},{key:"hasSource",value:function(){return 0<n("input.stripe-source").length}},{key:"createSource",value:function(){var e=this.getBillingDetails();return this.stripe.createSource(this.stripeCard,e).then(this.sourceResponse)}},{key:"sourceResponse",value:function(e){if(e.error)return n(document.body).trigger("stripeError",e);this.reset(),this.form.append(n('<input type="hidden" />').addClass("stripe-source").attr("name","stripe_source").val(e.source.id)),this.form.submit()}},{key:"getBillingDetails",value:function(){return{}}},{key:"onCCFormChange",value:function(){this.reset()}},{key:"updateCardBrand",value:function(e){var t={visa:"stripe-visa-brand",mastercard:"stripe-mastercard-brand",amex:"stripe-amex-brand",discover:"stripe-discover-brand",diners:"stripe-diners-brand",jcb:"stripe-jcb-brand",unknown:"stripe-credit-card-brand"},r=n(document.getElementsByClassName("stripe-card-brand")),i="stripe-credit-card-brand";e in t&&(i=t[e]),n.each(t,(function(e,t){r.removeClass(t)})),r.addClass(i)}},{key:"reset",value:function(){n(".edd-loading-ajax").remove(),n(".edd_errors, .stripe-source").remove(),n(".edd-error").hide()}}]),e}(),n(document).ready((function(){new i}))},function(e,t,r){}]);